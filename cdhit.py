seqs = {}

with open("ECA2530-Cache_1100_cdhit98.fa.clstr") as f1:
    for line in f1:
        if "*" in line: # seqs kept by cdhit
            keep = line.split(">")[1].split(".")[0]
            seqs[keep] = []
        elif line[0] != ">": # seqs removed by cdhit
            seqs[keep].append(line.split(">")[1].split(".")[0])

# seqs from tree sCache_PC3 clade (kept by cdhit)
cp3 = '''WP_189356302
WP_077296610
WP_273481044
WP_273668800
WP_126126421
WP_241456049
WP_186948823
WP_186951967
WP_162041972
WP_110254127
WP_199762558
WP_279762877
WP_093389940
WP_051780933
WP_094441111
WP_152241925
WP_065306698
WP_092794779
WP_092714649
WP_230516393
WP_076566594
WP_071076460
WP_099763118
WP_289944340
WP_196855526
WP_152285280
WP_096236478
WP_086140358
WP_289885862
WP_250195228
WP_046111989
WP_188723063
WP_130834826
WP_221196947
WP_121043245
WP_154134843
WP_182992742
WP_241812083
WP_079216415
WP_275012282
WP_245200283
WP_094566535
WP_116435792
WP_008120306
WP_265113035
WP_222204479
WP_293804530
WP_301260906
WP_093380740
WP_222245813
WP_286655375
WP_281149703
WP_093213715
WP_298923914
WP_175506275
WP_231043658
WP_266006053
WP_269840533
WP_261760081
WP_279761276
WP_147243024
WP_297524252
WP_058933166
WP_088453964
WP_045267477
WP_088886924
WP_264371580
WP_195793502
WP_057265236
WP_007856680
WP_094476804
WP_076069202
WP_099743152
WP_274114771
WP_218380757
WP_233589785
WP_235507401
WP_255407079
WP_057228976
WP_298453743
WP_233244637
WP_291468537
WP_092743331
WP_131282041
WP_035609835
WP_006298412
WP_056668793
WP_019702589
WP_271461812
WP_208226965
WP_048638654
WP_109053431
WP_136165032
WP_280514770
WP_264642793
WP_136167916
WP_009114609
WP_136157342
WP_249230239
WP_012765333
WP_035341351
WP_125259135
WP_255556156
WP_039344458
WP_111778496
WP_285666271
WP_219606614
WP_225087883
WP_015840044
WP_271873123
WP_261847636
WP_255764708
WP_025918999
WP_039300509
WP_263499226
WP_275070378
WP_011094075'''.split()

# get all seqs from sCache_PC3 before removing by cdhit
before = cp3[:]
for after in cp3:
    before += seqs[after]

with open("sCache_CP3_before.txt", 'w') as f2:
    f2.write('\n'.join(before))
